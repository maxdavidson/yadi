!function(t,e){if("function"==typeof define&&define.amd)define(["exports"],e);else if("undefined"!=typeof exports)e(exports);else{var n={exports:{}};e(n.exports),t.yadi=n.exports}}(this,function(t){"use strict";function e(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return function(t){t.inject=e}}var n=Function.prototype.bind,o=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};t.__esModule=!0,t.inject=e;var i=function(){function t(e,n){r(this,t),this._injector=e,this._key=n,this.toInstanceOf(n,n),Object.freeze(this)}return t.prototype.toValue=function(t){this._injector._data.set(this._key,{type:"value",value:t})},t.prototype.toFactory=function(t){var e=void 0===arguments[1]?{}:arguments[1],n=e.inject,o=void 0===n?[]:n,r=e.memoize,i=void 0===r?!0:r;this._injector._data.set(this._key,{type:"factory",fn:t,inject:o,memoize:i})},t.prototype.toInstanceOf=function(t){var e=void 0===arguments[1]?{}:arguments[1],n=e.memoize,o=void 0===n?!0:n;this._injector._data.set(this._key,{type:"constructor",implementation:t,memoize:o})},t}(),a=function(t){function e(n){r(this,e);var o="function"==typeof n?n.name:n,i=new t('No provider associated for dependency "'+o+'" ('+typeof n+")");return i.__proto__=e.prototype,i}return o(e,t),e}(Error);t.InjectionError=a;var s=function(){function t(){r(this,t),this._data=new Map,this.register(t).toValue(this),Object.freeze(this)}return t.prototype.register=function(t){return new i(this,t)},t.prototype.get=function(t){var e=this;if(!this._data.has(t))throw new a(t);var n=this._data.get(t),o=function(o){return n.memoize&&e.register(t).toValue(o),o};switch(n.type){case"value":return Promise.resolve(n.value);case"factory":return o(Promise.all(n.inject.map(this.get,this)).then(function(t){return n.fn.apply(n,t)}));case"constructor":return o(this.create(n.implementation))}},t.prototype.create=function(t){var o=t.inject||[];return"function"==typeof o&&(o=e.call(t)),Promise.all(o.map(this.get,this)).then(function(e){return new(n.apply(t,[null].concat(e)))})},t}();t.Injector=s});